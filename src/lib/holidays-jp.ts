// holidays-jp-from-2020.ts
/**
 * @file 日本の祝日データと関連ユーティリティ
 * @module holidays-jp
 */

/**
 * 祝日データを格納するオブジェクト。
 * キーは 'YYYY-MM-DD' 形式の日付文字列、値は祝日名。
 * @type { [key: string]: string }
 */
export const holidays: { [key: string]: string } = {
  '2020-01-01': '元日',
  '2020-01-13': '成人の日',
  '2020-02-11': '建国記念の日',
  '2020-02-23': '天皇誕生日',
  '2020-02-24': '休日',
  '2020-03-20': '春分の日',
  '2020-04-29': '昭和の日',
  '2020-05-03': '憲法記念日',
  '2020-05-04': 'みどりの日',
  '2020-05-05': 'こどもの日',
  '2020-05-06': '休日',
  '2020-07-23': '海の日',
  '2020-07-24': 'スポーツの日',
  '2020-08-10': '山の日',
  '2020-09-21': '敬老の日',
  '2020-09-22': '秋分の日',
  '2020-11-03': '文化の日',
  '2020-11-23': '勤労感謝の日',
  '2021-01-01': '元日',
  '2021-01-11': '成人の日',
  '2021-02-11': '建国記念の日',
  '2021-02-23': '天皇誕生日',
  '2021-03-20': '春分の日',
  '2021-04-29': '昭和の日',
  '2021-05-03': '憲法記念日',
  '2021-05-04': 'みどりの日',
  '2021-05-05': 'こどもの日',
  '2021-07-22': '海の日',
  '2021-07-23': 'スポーツの日',
  '2021-08-08': '山の日',
  '2021-08-09': '休日',
  '2021-09-20': '敬老の日',
  '2021-09-23': '秋分の日',
  '2021-11-03': '文化の日',
  '2021-11-23': '勤労感謝の日',
  '2022-01-01': '元日',
  '2022-01-10': '成人の日',
  '2022-02-11': '建国記念の日',
  '2022-02-23': '天皇誕生日',
  '2022-03-21': '春分の日',
  '2022-04-29': '昭和の日',
  '2022-05-03': '憲法記念日',
  '2022-05-04': 'みどりの日',
  '2022-05-05': 'こどもの日',
  '2022-07-18': '海の日',
  '2022-08-11': '山の日',
  '2022-09-19': '敬老の日',
  '2022-09-23': '秋分の日',
  '2022-10-10': 'スポーツの日',
  '2022-11-03': '文化の日',
  '2022-11-23': '勤労感謝の日',
  '2023-01-01': '元日',
  '2023-01-02': '休日',
  '2023-01-09': '成人の日',
  '2023-02-11': '建国記念の日',
  '2023-02-23': '天皇誕生日',
  '2023-03-21': '春分の日',
  '2023-04-29': '昭和の日',
  '2023-05-03': '憲法記念日',
  '2023-05-04': 'みどりの日',
  '2023-05-05': 'こどもの日',
  '2023-07-17': '海の日',
  '2023-08-11': '山の日',
  '2023-09-18': '敬老の日',
  '2023-09-23': '秋分の日',
  '2023-10-09': 'スポーツの日',
  '2023-11-03': '文化の日',
  '2023-11-23': '勤労感謝の日',
  '2024-01-01': '元日',
  '2024-01-08': '成人の日',
  '2024-02-11': '建国記念の日',
  '2024-02-12': '休日',
  '2024-02-23': '天皇誕生日',
  '2024-03-20': '春分の日',
  '2024-04-29': '昭和の日',
  '2024-05-03': '憲法記念日',
  '2024-05-04': 'みどりの日',
  '2024-05-05': 'こどもの日',
  '2024-05-06': '休日',
  '2024-07-15': '海の日',
  '2024-08-11': '山の日',
  '2024-08-12': '休日',
  '2024-09-16': '敬老の日',
  '2024-09-22': '秋分の日',
  '2024-09-23': '休日',
  '2024-10-14': 'スポーツの日',
  '2024-11-03': '文化の日',
  '2024-11-04': '休日',
  '2024-11-23': '勤労感謝の日',
  '2025-01-01': '元日',
  '2025-01-13': '成人の日',
  '2025-02-11': '建国記念の日',
  '2025-02-23': '天皇誕生日',
  '2025-02-24': '休日',
  '2025-03-20': '春分の日',
  '2025-04-29': '昭和の日',
  '2025-05-03': '憲法記念日',
  '2025-05-04': 'みどりの日',
  '2025-05-05': 'こどもの日',
  '2025-05-06': '休日',
  '2025-07-21': '海の日',
  '2025-08-11': '山の日',
  '2025-09-15': '敬老の日',
  '2025-09-23': '秋分の日',
  '2025-10-13': 'スポーツの日',
  '2025-11-03': '文化の日',
  '2025-11-23': '勤労感謝の日',
  '2025-11-24': '休日',
  '2026-01-01': '元日',
  '2026-01-12': '成人の日',
  '2026-02-11': '建国記念の日',
  '2026-02-23': '天皇誕生日',
  '2026-03-20': '春分の日',
  '2026-04-29': '昭和の日',
  '2026-05-03': '憲法記念日',
  '2026-05-04': 'みどりの日',
  '2026-05-05': 'こどもの日',
  '2026-05-06': '休日',
  '2026-07-20': '海の日',
  '2026-08-11': '山の日',
  '2026-09-21': '敬老の日',
  '2026-09-22': '休日',
  '2026-09-23': '秋分の日',
  '2026-10-12': 'スポーツの日',
  '2026-11-03': '文化の日',
  '2026-11-23': '勤労感謝の日',
};

/**
 * Dateオブジェクトまたは日付文字列を 'YYYY-MM-DD' 形式の文字列に変換します。
 * @param {Date | string} date - 変換する日付。
 * @returns {string} 'YYYY-MM-DD' 形式の日付文字列。
 * @throws {Error} 無効な日付が指定された場合。
 */
const toDateString = (date: Date | string): string => {
  if (typeof date === 'string') {
    date = new Date(date);
  } else if (!(date instanceof Date)) {
    throw new Error('Invalid date');
  }

  const yyyy = date.getFullYear();
  const mm = (date.getMonth() + 1).toString().padStart(2, '0');
  const dd = date.getDate().toString().padStart(2, '0');
  return [yyyy, mm, dd].join('-');
};

/**
 * 指定された日付が祝日であるかどうかを判定します。
 * @param {Date | string} date - 判定する日付。
 * @returns {boolean} 祝日であれば `true`、そうでなければ `false`。
 */
export const isHoliday = (date: Date | string): boolean => {
  const key = toDateString(date);
  return key in holidays;
};

/**
 * 指定された日付の祝日名を取得します。
 * @param {Date | string} date - 祝日名を取得する日付。
 * @returns {string | null} 祝日名。祝日でない場合は `null`。
 */
export const getHolidayName = (date: Date | string): string | null => {
  const key = toDateString(date);
  return holidays[key] || null;
};
